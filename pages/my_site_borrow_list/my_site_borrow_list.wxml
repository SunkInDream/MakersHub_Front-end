<!--pages/my_site_borrow_list/my_site_borrow_list.wxml-->

<view class="container">
  <!-- 顶部导航栏，包含页面标题和编辑图标 -->
  <navBar class="navbar"
          title="我的场地"
          background="#222831"
          color="#fff"
          back="{{true}}"
          home="{{true}}"
          iconTheme="white"
          bindback="handlerGobackClick"
          bindhome="handlerGohomeClick" />

  <!-- 下半 切换 -->
  <view class="tab">
    <text bindtap="changeItem" data-item="0" class="{{tab==0?'active':''}}">在约</text>
    <text bindtap="changeItem" data-item="1" class="{{tab==1?'active':''}}">借用中</text>
    <text bindtap="changeItem" data-item="2" class="{{tab==2?'active':''}}">已归还</text>
    <text bindtap="changeItem" data-item="3" class="{{tab==3?'active':''}}">已取消</text>
  </view>

  <!-- 内容区域 swiper 切换 -->
  <swiper current="{{tab}}" bindchange="onSwiperChange">
  <!-- 在约 tab -->
  <swiper-item>
      <view class="list-container">
      <block wx:if="{{unpermittedList.length > 0}}">
          <block wx:for="{{unpermittedList}}" wx:key="apply_id">
            <view class="item-container">
              <view class="item-details">
                <text class="name">{{item.site}}  [工位{{item.number}}]</text>
                <text class="label">申请创建时间：</text>
                <view class="time-and-state">
                  <text class="create-time">{{item.formatted_time}}</text>
                  <view class="state" style="background-color: {{stateColors[item.state]}}; color: {{stateText[item.state]}}">{{stateTag[item.state]}}</view>
                </view>
              </view>
              <view class="detail-btn" data-apply-id="{{item.apply_id}}" bindtap="navigateToDetail">详情</view>
            </view>
          </block>
        </block>
        <block wx:else>
          <view class="empty-hint">
            <text>这里还什么都没有哦\n快去申请喵~</text>
          </view>
        </block>
      </view>
    </swiper-item>
    
    <!-- 借用中 tab -->
    <swiper-item>
      <view class="list-container">
        <block wx:if="{{borrowingList.length > 0}}">
          <block wx:for="{{borrowingList}}" wx:key="apply_id">
            <view class="item-container">
              <view class="item-details">
                <text class="name">{{item.site}}  [工位{{item.number}}]</text>
                <text class="label">申请创建时间：</text>
                <view class="time-and-state">
                  <text class="create-time">{{item.formatted_time}}</text>
                  <view class="state" style="background-color: {{stateColors[item.state]}}; color: {{stateText[item.state]}}">{{stateTag[item.state]}}</view>
                </view>
              </view>
              <view class="detail-btn" data-apply-id="{{item.apply_id}}" bindtap="navigateToDetail">详情</view>
            </view>
          </block>
        </block>
        <block wx:else>
          <view class="empty-hint">
            <text>这里还什么都没有哦\n快去申请喵~</text>
          </view>
        </block>
      </view>
    </swiper-item>

    <!-- 已归还 tab -->
    <swiper-item>
      <view class="list-container">
        <block wx:if="{returnedList.length > 0}}">
          <block wx:for="{{returnedList}}" wx:key="apply_id">
            <view class="item-container">
              <view class="item-details">
                <text class="name">{{item.site}}  [工位{{item.number}}]</text>
                <text class="label">申请创建时间：</text>
                <view class="time-and-state">
                  <text class="create-time">{{item.formatted_time}}</text>
                  <view class="state" style="background-color: {{stateColors[item.state]}}; color: {{stateText[item.state]}}">{{stateTag[item.state]}}</view>
                </view>
              </view>
              <view class="detail-btn" data-apply-id="{{item.apply_id}}" bindtap="navigateToDetail">详情</view>
            </view>
          </block>
        </block>
        <block wx:else>
          <view class="empty-hint">
            <text>
              这里还什么都没有哦\n记得归还场地喵~
            </text>
          </view>
        </block>
      </view>
    </swiper-item>

    <!--已取消-->
    <swiper-item>
      <view class="list-container">
        <block wx:if="{{cancelledList.length > 0}}">
          <block wx:for="{{cancelledList}}" wx:key="apply_id">
            <view class="item-container">
              <view class="item-details">
                <text class="name">{{item.site}}  [工位{{item.number}}]</text>
                <text class="label">申请创建时间：</text>
                <view class="time-and-state">
                  <text class="create-time">{{item.formatted_time}}</text>
                  <view class="state" style="background-color: {{stateColors[item.state]}}; color: {{stateText[item.state]}}">{{stateTag[item.state]}}</view>
                </view>
              </view>
              <view class="detail-btn" data-apply-id="{{item.apply_id}}" bindtap="navigateToDetail">详情</view>
            </view>
          </block>
        </block>
        <block wx:else>
          <view class="empty-hint">
            <text>还没有取消的场地申请哦</text>
          </view>
        </block>
      </view>
    </swiper-item>    
  </swiper>

  <!-- 底部装饰图片 -->
  <image class="bottom-image" src="/images/stuff_borrow_permit_list/white_cat.svg" mode="widthFix" />
</view>
